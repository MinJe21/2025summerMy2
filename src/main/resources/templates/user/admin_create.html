<!DOCTYPE html>
<html lang="en">

<th:block th:replace="~{/includes/admin/head}" />

<body id="page-top">

<!-- Page Wrapper -->
<div id="wrapper">

    <th:block th:replace="~{/includes/admin/sidebar}" />
    <script>
        $(".nav_permission_a").removeClass("collapsed");
        $(".nav_permission_div").addClass("show");
    </script>

    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">

        <!-- Main Content -->
        <div id="content">

            <th:block th:replace="~{/includes/admin/topbar}" />

            <!-- Begin Page Content -->
            <div class="container-fluid">

                <!-- Page Heading -->
                <h1 class="h3 mb-2 text-gray-800">사용자 생성</h1>
                <p class="mb-4">신규 생성 입니다.</p>

                <div class="mb-4">
                    <div class="form-group row">

                        <label class="col-sm-2 col-form-label">*아이디</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control mb-2" id="create_user_username" placeholder="아이디를 입력해주세요!" />
                        </div>

                        <label class="col-sm-2 col-form-label">*비밀번호</label>
                        <div class="col-sm-4">
                            <input type="password" class="form-control mb-2" id="create_user_password" placeholder="비밀번호를 입력해주세요!" />
                        </div>

                        <label class="col-sm-2 col-form-label">*이름</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control mb-2" id="create_user_name" placeholder="이름을 입력해주세요!" />
                        </div>

                        <label class="col-sm-2 col-form-label">*닉네임</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control mb-2" id="create_user_nick" placeholder="닉네임을 입력해주세요!" />
                        </div>

                        <label class="col-sm-2 col-form-label">*전화번호</label>
                        <div class="col-sm-4">
                            <input type="text" class="form-control mb-2" id="create_user_phone" placeholder="전화번호를 입력해주세요!" />
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="create_user(); return false;">생성하기</button>
            </div>

        </div>

        <th:block th:replace="~{/includes/admin/footer}" />

    </div>

</div>

<th:block th:replace="~{/includes/admin/bottom}" />

<script>
    $(document).ready(function() {
        console.log("ready!");
    });

    // ✅ 필수 값 체크 + param 생성
    function listenerCreateParam() {
        let username = $("#create_user_username").val().trim();
        let password = $("#create_user_password").val().trim();
        let name     = $("#create_user_name").val().trim();
        let nick     = $("#create_user_nick").val().trim();
        let phone    = $("#create_user_phone").val().trim();

        if (!username) return alert("아이디를 입력해주세요.");
        if (!password) return alert("비밀번호를 입력해주세요.");
        if (!name)     return alert("이름을 입력해주세요.");
        if (!nick)     return alert("닉네임을 입력해주세요.");
        if (!phone)    return alert("전화번호를 입력해주세요.");

        return { username, password, name, nick, phone };
    }

    // ✅ 생성 요청
    function create_user(){
        let _param = listenerCreateParam();
        let _data = {
            url: "/api/user",
            type: "POST",
            param: _param,
            headers: {
                "Authorization": "Bearer " + localStorage.getItem("token") // 로그인 후 저장한 토큰
            },
            success: function(obj_data, obj_status, obj_xhr){
                alert("등록 성공");
                location.reload();
            },
            error: function(obj_data, obj_status, obj_xhr){
                alert("정상적으로 이루어지지 않았습니다. 다시 시도해주세요.");
            }
        };
        func_ajax(_data);
    }

</script>

</body>
</html>
